geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("grey30","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
ggsave("figures/cpitrends.pdf",width=9,height=5)
ggsave("figures/cpitrends.png",width=9,height=5,scale=1)
scan()
3
35
5
v<-scan()
mean(v)
hist(v)
require(readr)
require(dplyr)
require(stargazer)
dk94raw<-read_csv(file="/Users/frederikhjorth/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
View(dk94raw)
require(readr)
require(dplyr)
require(stargazer)
#get 98 and 2001 data
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk98raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-1998/ElectionStudy-1998_F1.csv")
dk01raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-2001/ElectionStudy-2001_F1.csv")
#recode data
dk94<-dk94raw %>%
transmute(immthreat=ifelse(v277<6,(v277-5)/-4,NA),
euredist=ifelse(v312<6,(v312-1)/4,NA),
euexp=ifelse(v316<6,(v316-1)/4,NA),
elec="1994")
dk98<-dk98raw %>%
transmute(immthreat=ifelse(v120<6,(v120-5)/-4,NA),
euredist=ifelse(v156<6,(v156-1)/4,NA),
euexp=ifelse(v160<6,(v160-1)/4,NA),
elec="1998")
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
View(dkm_9498)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(euredist~immthreat,data=dk94))
summary(lm(euredist~immthreat,data=dk98))
summary(lm(euredist~immthreat,data=dk01))
require(readr)
require(dplyr)
require(stargazer)
#get 98 and 2001 data
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk98raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-1998/ElectionStudy-1998_F1.csv")
dk01raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-2001/ElectionStudy-2001_F1.csv")
#check vars
table(dk98raw$v156)
#recode data
dk94<-dk94raw %>%
transmute(immthreat=ifelse(v277<6,(v277-5)/-4,NA),
euredist=ifelse(v312<6,(v312-1)/4,NA),
euexp=ifelse(v316<6,(v316-1)/4,NA),
eucurr=ifelse(v314<6,(v314-5)/-4,NA),
eugen=ifelse(v318<6,(v318-5)/-4,NA),
elec="1994")
dk98<-dk98raw %>%
transmute(immthreat=ifelse(v120<6,(v120-5)/-4,NA),
euredist=ifelse(v156<6,(v156-1)/4,NA),
euexp=ifelse(v160<6,(v160-1)/4,NA),
eucurr=NA,
eugen=NA,
elec="1998")
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
eucurr=NA,
eugen=ifelse(v318<6,(v318-5)/-4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
dkm_9401<-dk94 %>%
rbind(.,dk01)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
eucurr=NA,
eugen=ifelse(v172<6,(v172-5)/-4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
dkm_9401<-dk94 %>%
rbind(.,dk01)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
summary(lm(eugen~immthreat,data=dk94))
summary(lm(eugen~immthreat,data=dk01))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
require(haven)
se94raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0570 Swedish Election Study 1994/0570EU.dta")
se02raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0812 Swedish Election Study 2002/0812EU.dta")
se02raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0812 Swedish Election Study 2002/0812EV.dta")
str(se02raw)
str(se94raw)
str(se94raw)
str(se94raw)
str(se02raw)
1+1+5+2.5+1+2.5+1.5+2.5+1,5+1+5+5
1+1+5+2.5+1+2.5+1.5+2.5+1.5+1+5+5
1+1+5+2.5+1+2.5+1.5+2.5+1.5+1+5+5-1+9
setwd("~/GitHub/parlbias/data")
ftall<-readRDS("ftall.rds")
require(lubridate)
require(dplyr)
require(magrittr)
require(ggplot2)
require(reshape2)
require(stargazer)
require(readr)
write_csv(ftall,"ftall.csv")
require(lubridate)
require(dplyr)
require(magrittr)
require(ggplot2)
require(reshape2)
require(stargazer)
require(readr)
require(zoo)
#win
#setwd("C:/Users/fh/Documents/GitHub/parlbias/data")
#mac
setwd("~/GitHub/parlbias/data")
ftall<-readRDS("ftall.rds")
#remove very short and very long speeches
ft<-subset(ftall,secs<150 & secs>10 & year(starttime)>2000)
ft<-arrange(ft,starttime)
ggplot(ft,aes(x=timeofday,y=secs)) + geom_point() + facet_grid(debate~.)
ggplot(subset(ft,chair==0),aes(x=secs)) + geom_density()
summary(m1<-lm(secs~copartisan,data=ft))
summary(m2<-lm(secs~copartisan+timeofday,data=ft))
summary(m3<-lm(secs~copartisan+timeofday+female,data=ft))
summary(m4<-lm(secs~copartisan+timeofday+female+factor(chairparty),data=ft))
summary(m5<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=ft))
summary(m6<-lm(secs~copartisan+timeofday+female+debate,data=ft))
summary(m7<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=subset(ft,leadshipparty==1)))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("debate"),omit.stat=c("f","ser"))
ggplot(ft,aes(x=timeofday,y=secs)) + geom_point() + facet_grid(debate~.)
require(lubridate)
require(dplyr)
require(magrittr)
require(ggplot2)
require(reshape2)
require(stargazer)
require(readr)
require(zoo)
#win
#setwd("C:/Users/fh/Documents/GitHub/parlbias/data")
#mac
setwd("~/GitHub/parlbias/data")
ftall<-readRDS("ftall.rds")
#remove very short and very long speeches
ft<-subset(ftall,secs<100 & secs>10 & year(starttime)>2000)
ft<-arrange(ft,starttime)
#check sample of data
sample_n(ft,30)
ggplot(subset(ft,chair==0),aes(x=secs)) + geom_density()
ggplot(ft,aes(x=timeofday,y=secs)) + geom_point() + facet_grid(debate~.)
### TABLES
summary(m1<-lm(secs~copartisan,data=ft))
summary(m2<-lm(secs~copartisan+timeofday,data=ft))
summary(m3<-lm(secs~copartisan+timeofday+female,data=ft))
summary(m4<-lm(secs~copartisan+timeofday+female+factor(chairparty),data=ft))
summary(m5<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=ft))
summary(m6<-lm(secs~copartisan+timeofday+female+debate,data=ft))
summary(m7<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=subset(ft,leadshipparty==1)))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("debate"),omit.stat=c("f","ser"))
require(lubridate)
require(dplyr)
require(magrittr)
require(ggplot2)
require(reshape2)
require(stargazer)
require(readr)
require(zoo)
#win
#setwd("C:/Users/fh/Documents/GitHub/parlbias/data")
#mac
setwd("~/GitHub/parlbias/data")
ftall<-readRDS("ftall.rds")
#remove very short and very long speeches
ft<-subset(ftall,secs<150 & secs>5 & year(starttime)>2000)
ft<-arrange(ft,starttime)
#check sample of data
sample_n(ft,30)
ggplot(subset(ft,chair==0),aes(x=secs)) + geom_density()
ggplot(ft,aes(x=timeofday,y=secs)) + geom_point() + facet_grid(debate~.)
### TABLES
summary(m1<-lm(secs~copartisan,data=ft))
summary(m2<-lm(secs~copartisan+timeofday,data=ft))
summary(m3<-lm(secs~copartisan+timeofday+female,data=ft))
summary(m4<-lm(secs~copartisan+timeofday+female+factor(chairparty),data=ft))
summary(m5<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=ft))
summary(m6<-lm(secs~copartisan+timeofday+female+debate,data=ft))
summary(m7<-lm(secs~copartisan+timeofday+female+factor(coarseparty),data=subset(ft,leadshipparty==1)))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,m6,m7,type="text",omit=c("debate"),omit.stat=c("f","ser"))
m1<-lm(m1f<-as.formula(secs~copartisan),data=ft)
m2<-lm(m2f<-as.formula(secs~copartisan+timeofday+female),data=ft)
m3<-lm(m3f<-as.formula(secs~copartisan+timeofday+female+factor(chairparty)),data=ft)
m4<-lm(m4f<-as.formula(secs~copartisan+timeofday+female+factor(coarseparty)),data=ft)
m5<-lm(m5f<-as.formula(secs~copartisan+timeofday+female+debate),data=ft)
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("debate"),omit.stat=c("f","ser"))
summary(mx<-lm(secs~copartisan+timeofday+female+factor(coarseparty)+factor(chairparty),data=ft))
summary(mx<-lm(secs~copartisan+timeofday+female+factor(coarseparty)+factor(chairparty)+debate,data=ft))
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
summary(m5intposdifltmedian<-lm(m5f,data=subset(ft,intposdif<=2.34)))
summary(m5ordposdifltmedian<-lm(m5f,data=subset(ft,ordposdif<=2)))
summary(m5cobloc<-lm(m5f,data=subset(ft,cobloc==1)))
#define basic models
m1<-lm(m1f<-as.formula(secs~copartisan),data=ft)
m2<-lm(m2f<-as.formula(secs~copartisan+timeofday+female),data=ft)
m3<-lm(m3f<-as.formula(secs~copartisan+timeofday+female+factor(chairparty)+factor(coarseparty)),data=ft)
m4<-lm(m4f<-as.formula(secs~copartisan+timeofday+female+debate),data=ft)
m5<-lm(m5f<-as.formula(secs~copartisan+timeofday+female+debate+factor(chairparty)+factor(coarseparty)),data=ft)
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
#define basic models
m1<-lm(m1f<-as.formula(secs~copartisan),data=ft)
m2<-lm(m2f<-as.formula(secs~copartisan+timeofday+female),data=ft)
m3<-lm(m3f<-as.formula(secs~copartisan+timeofday+female+factor(chairparty)+factor(coarseparty)),data=ft)
m4<-lm(m4f<-as.formula(secs~copartisan+timeofday+female+debate),data=ft)
m5<-lm(m5f<-as.formula(secs~copartisan+timeofday+female+debate+factor(chairparty)+factor(coarseparty)),data=ft)
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("debate"),omit.stat=c("f","ser"))
summary(m5intposdifltmedian<-lm(m5f,data=subset(ft,intposdif<=2.34)))
summary(m5ordposdifltmedian<-lm(m5f,data=subset(ft,ordposdif<=2)))
summary(m5cobloc<-lm(m5f,data=subset(ft,cobloc==1)))
require(tidyr)
require(broom)
tidy(m1)
effectests<-data.frame(est=rep(NA,10),se=rep(NA,10),method=c(rep("OLS",5),rep("Logit",5)),model=rep(1:5,2))
effectests[1,1:2]<-tidy(m1)[2,1:2]
effectests[2,1:2]<-tidy(m2)[2,1:2]
effectests[3,1:2]<-tidy(m3)[2,1:2]
effectests[4,1:2]<-tidy(m4)[2,1:2]
effectests[5,1:2]<-tidy(m5)[2,1:2]
effectests
tidy(m1)
effectests<-data.frame(est=rep(NA,10),se=rep(NA,10),method=c(rep("OLS",5),rep("Logit",5)),model=rep(1:5,2))
effectests[1,1:2]<-tidy(m1)[2,2:3]
effectests[2,1:2]<-tidy(m2)[2,2:3]
effectests[3,1:2]<-tidy(m3)[2,2:3]
effectests[4,1:2]<-tidy(m4)[2,2:3]
effectests[5,1:2]<-tidy(m5)[2,2:3]
#what is the effect size in standardized terms? get cohen's d
cohensd <- effectests$est / sd(ft$secs)
barplot(cohensd)
#get average number of speeches
lengths<-ft %>%
group_by(year(starttime),debatetype,chairname) %>%
summarise(speeches=sum(chair)) %>%
filter(speeches>0)
meanspeechesperchair<-mean(lengths$speeches)
#how many minutes does 2.8 seconds add up to over the average debate per chair?
effectests$est[4]*meanspeechesperchair/60
effectests
lengths
View(lengths)
#get average number of speeches
lengths<-ft %>%
group_by(debate,chairname) %>%
summarise(speeches=sum(chair)) %>%
filter(speeches>0)
View(lengths)
meanspeechesperchair<-mean(lengths$speeches)
#how many minutes does 2.8 seconds add up to over the average debate per chair?
effectests$est[4]*meanspeechesperchair/60
summary(m1.logit<-glm(secsgt60~copartisan,data=ft,family=binomial()))
summary(m2.logit<-glm(secsgt60~copartisan+timeofday+female,data=ft,family=binomial()))
summary(m3.logit<-glm(secsgt60~copartisan+timeofday+female+factor(chairparty)+factor(coarseparty),data=ft,family=binomial()))
summary(m4.logit<-glm(secsgt60~copartisan+timeofday+female+debate,data=ft,family=binomial()))
summary(m5.logit<-glm(secsgt60~copartisan+timeofday+female+debate+factor(chairparty)+factor(coarseparty),data=ft,family=binomial()))
require(mfx)
effectests[6,1:2]<-logitmfx(m1.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[7,1:2]<-logitmfx(m2.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[8,1:2]<-logitmfx(m3.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[9,1:2]<-logitmfx(m4.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[10,1:2]<-logitmfx(m5.logit$formula,data=ft)$mfxest[1,1:2]*100
require(rms)
m1rob<-robcov(ols(m1f,data=ft,x=T,y=T),cluster=ft$chairname)
m2rob<-robcov(ols(m2f,data=ft,x=T,y=T),cluster=ft$chairname)
m3rob<-robcov(ols(m3f,data=ft,x=T,y=T),cluster=ft$chairname)
m4rob<-robcov(ols(m4f,data=ft,x=T,y=T),cluster=ft$chairname)
m5rob<-robcov(ols(m5f,data=ft,x=T,y=T),cluster=ft$chairname)
print(m4rob)
print(m5rob)
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit.stat=c("f","chi2"),dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",label="parlbias_regtab1",column.sep.width="5pt",covariate.labels=c("Copartisan","Prime minister","Time of day","Debate type: Opening","Gender (female)","Age of speaker","Intercept"),star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2) #,type="text")
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",label="parlbias_regtab1",column.sep.width="5pt",covariate.labels=c("Copartisan","Prime minister","Time of day","Debate type: Opening","Gender (female)","Age of speaker","Intercept"),star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2) #,type="text")
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1",column.sep.width="5pt",star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2)
covariate.labels=c("Copartisan","Time of day","Gender (female)","Intercept"))
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1",column.sep.width="5pt",star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2,
covariate.labels=c("Copartisan","Time of day","Gender (female)","Intercept"))
regtab1[30]
length(regtab1)
regtab1[25]
regtab1[22]
regtab1<-c(regtab1[1:22],checkmarks,regtab1[23:length(regtab1)])
?rms
require(stargazer)
checkmarks<-c("Speaker party fixed effects & & & \\checkmark & & \\checkmark \\\\", "Chair party fixed effects & & & \\checkmark & & \\checkmark \\\\", "Debate fixed effects & & & & \\checkmark & \\checkmark \\\\")
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1",column.sep.width="5pt",star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2,
covariate.labels=c("Copartisan","Time of day","Gender (female)","Intercept"))
regtab1<-c(regtab1[1:22],checkmarks,regtab1[23:length(regtab1)])
writeLines(regtab1,con="../tables/parlbias_regtab1.txt")
regtab1
covarlabs<-c("Copartisan","Time of day","Gender (female)","Intercept")
regtab1logit<-stargazer(m1.logit,m2.logit,m3.logit,m4.logit,m5.logit,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Dummy: speaking time exceeds 60 seconds",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1logit",column.sep.width="5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Logit models of exceeding standard speaking time",digits=2)
regtab1logit<-c(regtab1logit[1:22],checkmarks,regtab1logit[23:length(regtab1logit)])
writeLines(regtab1logit,con="../tables/parlbias_regtab1logit.txt")
regtabmods<-stargazer(m4,m4intposdifltmedian,m4ordposdifltmedian,m4cobloc,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods<-stargazer(m5,m5intposdifltmedian,m5ordposdifltmedian,m4cobloc,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods<-stargazer(m5,m5intposdifltmedian,m5ordposdifltmedian,m5cobloc,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
modscolumnlabels<-c("Full","Distance$\\leq$median (int.)","Distance$\\leq$median (ord.)","Same bloc")
regtabmods<-stargazer(m5,m5intposdifltmedian,m5ordposdifltmedian,m5cobloc,style="apsr",omit=c("coarse","chair","debate"),omit.stat=c("f","chi2"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods
regtabmods<-c(regtabmods[1:23],checkmarks,regtabmods[24:length(regtabmods)])
writeLines(regtabmods,con="../tables/parlbias_regtabmods.txt")
modeffectests<-data.frame(est=rep(NA,4),se=rep(NA,4),model=modscolumnlabels)
modeffectests[1,1:2]<-tidy(m5)[2,1:2]
modeffectests[2,1:2]<-tidy(m5intposdifltmedian)[2,1:2]
modeffectests[3,1:2]<-tidy(m5ordposdifltmedian)[2,1:2]
modeffectests[4,1:2]<-tidy(m5cobloc)[2,1:2]
#sub in <= for latex symbols
modeffectests$model<-modeffectests$model %>%
as.character() %>%
function(x){gsub("\\$\\\\leq\\$","<=",x)}
#sub in <= for latex symbols
modeffectests$model<-modeffectests$model %>%
as.character() %>%
gsub("\\$\\\\leq\\$","<=",.)
modeffectests
### SUMMARY STATS TABLES
ftall$type<-NA
ftall$type[ftall$secs<150]<-"Brief remark"
ftall$type[ftall$secs>=150]<-"Spokesperson speech"
ftall$type[ftall$secs>=150 & ftall$pm==1]<-"PM speech"
require(dplyr)
totaln<-nrow(subset(ftall,chair==0 & year(starttime)>2000))
totalsecs<-sum(subset(ftall,chair==0 & year(starttime)>2000)$secs)
sumstatstab<- subset(ftall,chair==0 & year(starttime)>2000) %>%
group_by(type) %>%
summarise(count=n(),nshare=100*(count/totaln),secshare=100*sum(secs)/totalsecs)
sumstatstabtex<-stargazer(sumstatstab,summary=F,digits=1,title="Types of speeches in opening and closing debates in the Folketing",label="parlbias_sumstatstab",font.size="footnotesize",align=T,colnames=T,rownames=F)
sumstatstabtex[12]<-"\\multicolumn{1}{l}{Type} & \\multicolumn{1}{r}{Number} & \\multicolumn{1}{r}{Share (numeric)} & \\multicolumn{1}{r}{Share (time-weighted)} \\\\ "
#awkward left alignment of labels
sumstatstabtex<-gsub("column\\{1\\}\\{c\\}\\{","column{1}{l}{",sumstatstabtex)
writeLines(sumstatstabtex,con="../tables/parlbias_sumstatstab.txt")
#reorder factor levels
effectests<-within(effectests,method<-factor(method,levels=c("OLS","Logit")))
#plot estimates
ggplot(effectests2,aes(x=est,y=reorder(model,rep(5:1,2)))) +
geom_point(size=2.5) +
facet_grid(.~method,scales="free_x") +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds/percentage points)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
ggplot(effectests,aes(x=est,y=reorder(model,rep(5:1,2)))) +
geom_point(size=2.5) +
facet_grid(.~method,scales="free_x") +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds/percentage points)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
#plot estimates
ggplot(effectests,aes(x=est,y=reorder(model,rep(5:1,2)))) +
geom_point(size=2.5) +
facet_grid(.~method,scales="free_x") +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds/percentage points)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
ggsave(file="../figures/parlbias_effectplot.pdf",height=4,width=9)
ggplot(modeffectests,aes(x=est,y=reorder(model,c(4,3,2,1)))) +
geom_point(size=2.5) +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
modeffectests
modeffectests<-data.frame(est=rep(NA,4),se=rep(NA,4),model=modscolumnlabels)
modeffectests[1,1:2]<-tidy(m5)[2,2:3]
modeffectests[2,1:2]<-tidy(m5intposdifltmedian)[2,2:3]
modeffectests[3,1:2]<-tidy(m5ordposdifltmedian)[2,2:3]
modeffectests[4,1:2]<-tidy(m5cobloc)[2,2:3]
ggplot(modeffectests,aes(x=est,y=reorder(model,c(4,3,2,1)))) +
geom_point(size=2.5) +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
modeffectests<-data.frame(est=rep(NA,4),se=rep(NA,4),model=modscolumnlabels)
modeffectests[1,1:2]<-tidy(m5)[2,2:3]
modeffectests[2,1:2]<-tidy(m5intposdifltmedian)[2,2:3]
modeffectests[3,1:2]<-tidy(m5ordposdifltmedian)[2,2:3]
modeffectests[4,1:2]<-tidy(m5cobloc)[2,2:3]
#sub in <= for latex symbols
modeffectests$model<-modeffectests$model %>%
as.character() %>%
gsub("\\$\\\\leq\\$","<=",.)
ggplot(modeffectests,aes(x=est,y=reorder(model,c(4,3,2,1)))) +
geom_point(size=2.5) +
geom_errorbarh(aes(xmin=est-1.96*se,xmax=est+1.96*se),height=0,size=.5) +
geom_errorbarh(aes(xmin=est-1.65*se,xmax=est+1.65*se),height=0,size=1.2) +
expand_limits(x=0) +
geom_vline(xintercept=0,linetype="dashed") +
xlab("Estimate (seconds)") +
ylab("Model") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
ggsave(file="../figures/parlbias_modeffectplot.pdf",height=4,width=9)
ft$copartisan_factor<-factor(ft$copartisan,labels=c("Non-copartisan","Co-partisan"))
ft$copartisan_factor<-factor(ft$copartisan_factor,levels(ft$copartisan_factor)[c(2,1)])
ggplot(subset(ft,chair==0 & !is.na(copartisan)),aes(x=secs)) +
geom_density(fill="gray",alpha=.5) +
facet_grid(.~copartisan_factor) +
geom_vline(xintercept=60,linetype="dashed") +
xlab("Speech duration (seconds)") +
ylab("") +
scale_y_continuous(breaks=c(0,.005,.01,.015),labels=c("0",".005",".01",".015")) +
scale_x_continuous(breaks=c(0,30,60,90,120),labels=c("0","30","60","90","120")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.border = element_rect(colour = "black"))
ggsave(file="../figures/parlbias_dens.pdf",height=5,width=9)
require(lmer)
mlm3<-lmer(secs~copartisan+timeofday+female+(1|chairparty)+(1+copartisan|coarseparty),data=ft)
require(lme4)
mlm3<-lmer(secs~copartisan+timeofday+female+(1|chairparty)+(1+copartisan|coarseparty),data=ft)
ranef(mlm3)
table(ft$coarseparty=="UFG")
table(ft$coarseparty)
