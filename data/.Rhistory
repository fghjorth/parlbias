geom_boxplot() +
coord_flip() +
labs(x="",y="Months to first response") +
theme_bw()
ggplot(ejr2,aes(x=Journal,y=First.Response)) +
geom_violin() +
coord_flip() +
labs(x="",y="Months to first response") +
theme_bw()
?geom_violin
ggplot(ejr2,aes(x=Journal,y=First.Response)) +
geom_violin(fill="dark gray") +
coord_flip() +
labs(x="",y="Months to first response") +
theme_bw()
require(rvest)
require(magrittr)
require(dplyr)
require(ggplot2)
url<-"http://www.econjobrumors.com/journals.php"
ejr<-url %>%
html() %>%
html_table() %>%
extract(2) %>%
as.data.frame()
ejr2<-ejr %>%
select(Journal,Result,First.Response) %>%
filter(Journal %in% c("American Economic Review",
"Quarterly Journal of Economics",
"Journal of Political Economy")) %>%
filter(Result %in% c("Ref Reject","Accepted"))
ggplot(ejr2,aes(x=Journal,y=First.Response)) +
geom_violin(fill="dark gray") +
coord_flip() +
labs(x="",y="Months to first response") +
theme_bw()
table(ejr2$Journal)
6600
160*.3
6600/48
4721/48
# setwd("~/GitHub/corruption")
setwd("~/git/corruption")
#get cpi data from OKFN
cpi<-read.csv("http://data.okfn.org/data/core/corruption-perceptions-index/r/cpi.csv")
#reshape
require(reshape2)
cpim<-melt(cpi)
#get year
cpim$year<-as.numeric(substr(cpim$variable,2,5))
#rescale pre2012 to 0-100
cpim$value.rs<-ifelse(cpim$year<2012,cpim$value*10,cpim$value)
#create conditional color and alpha
cpim$col<-0
cpim$col[cpim$Jurisdiction=="Denmark"]<-1
cpim$col[cpim$Jurisdiction=="India"]<-0 #2 when India highlighted
cpim$alph<-0.9
cpim$alph[cpim$Jurisdiction=="Denmark"]<-1
cpim$alph[cpim$Jurisdiction=="India"]<-.9 #1 when India highlighted
library("ggplot2")
#plot!
ggplot(cpim,aes(x=year,y=value.rs,group=Jurisdiction)) +
geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("grey","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
ggplot(cpim,aes(x=year,y=value.rs,group=Jurisdiction)) +
geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("dark grey","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
#plot!
ggplot(cpim,aes(x=year,y=value.rs,group=Jurisdiction)) +
geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("black","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
#plot!
ggplot(cpim,aes(x=year,y=value.rs,group=Jurisdiction)) +
geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("grey30","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
ggplot(cpim,aes(x=year,y=value.rs,group=Jurisdiction)) +
geom_line(aes(color=factor(col),alpha=alph),size=1) +
scale_color_manual(values=c("grey30","firebrick","forestgreen")) +
theme_minimal() +
labs(x="",y="Corruption Perceptions Index") +
theme(legend.position="none") +
#  annotate("text",x=2007,y=38,label="India",color="forestgreen",size=4) +
annotate("text",x=2008,y=97,label="Denmark",color="firebrick",size=4)
ggsave("figures/cpitrends.pdf",width=9,height=5)
ggsave("figures/cpitrends.png",width=9,height=5,scale=1)
scan()
3
35
5
v<-scan()
mean(v)
hist(v)
require(readr)
require(dplyr)
require(stargazer)
dk94raw<-read_csv(file="/Users/frederikhjorth/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
View(dk94raw)
require(readr)
require(dplyr)
require(stargazer)
#get 98 and 2001 data
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk98raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-1998/ElectionStudy-1998_F1.csv")
dk01raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-2001/ElectionStudy-2001_F1.csv")
#recode data
dk94<-dk94raw %>%
transmute(immthreat=ifelse(v277<6,(v277-5)/-4,NA),
euredist=ifelse(v312<6,(v312-1)/4,NA),
euexp=ifelse(v316<6,(v316-1)/4,NA),
elec="1994")
dk98<-dk98raw %>%
transmute(immthreat=ifelse(v120<6,(v120-5)/-4,NA),
euredist=ifelse(v156<6,(v156-1)/4,NA),
euexp=ifelse(v160<6,(v160-1)/4,NA),
elec="1998")
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
View(dkm_9498)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(euredist~immthreat,data=dk94))
summary(lm(euredist~immthreat,data=dk98))
summary(lm(euredist~immthreat,data=dk01))
require(readr)
require(dplyr)
require(stargazer)
#get 98 and 2001 data
dk94raw<-read_csv(file="C:/Users/fh/Dropbox/Data/ElectionStudy-1994/ElectionStudy-1994_F1.csv")
dk98raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-1998/ElectionStudy-1998_F1.csv")
dk01raw<-read_csv("C:/Users/fh/Dropbox/Data/ElectionStudy-2001/ElectionStudy-2001_F1.csv")
#check vars
table(dk98raw$v156)
#recode data
dk94<-dk94raw %>%
transmute(immthreat=ifelse(v277<6,(v277-5)/-4,NA),
euredist=ifelse(v312<6,(v312-1)/4,NA),
euexp=ifelse(v316<6,(v316-1)/4,NA),
eucurr=ifelse(v314<6,(v314-5)/-4,NA),
eugen=ifelse(v318<6,(v318-5)/-4,NA),
elec="1994")
dk98<-dk98raw %>%
transmute(immthreat=ifelse(v120<6,(v120-5)/-4,NA),
euredist=ifelse(v156<6,(v156-1)/4,NA),
euexp=ifelse(v160<6,(v160-1)/4,NA),
eucurr=NA,
eugen=NA,
elec="1998")
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
eucurr=NA,
eugen=ifelse(v318<6,(v318-5)/-4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
dkm_9401<-dk94 %>%
rbind(.,dk01)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
dk01<-dk01raw %>%
transmute(immthreat=ifelse(v122<6,(v122-5)/-4,NA),
euredist=ifelse(v166<6,(v166-1)/4,NA),
euexp=ifelse(v169<6,(v169-1)/4,NA),
eucurr=NA,
eugen=ifelse(v172<6,(v172-5)/-4,NA),
elec="2001")
dkm_9498<-dk94 %>%
rbind(.,dk98)
dkm_9401<-dk94 %>%
rbind(.,dk01)
summary(lm(euredist~elec*immthreat,data=dkm_9498))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
summary(lm(eugen~immthreat,data=dk94))
summary(lm(eugen~immthreat,data=dk01))
summary(lm(eugen~elec*immthreat,data=dkm_9401))
require(haven)
se94raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0570 Swedish Election Study 1994/0570EU.dta")
se02raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0812 Swedish Election Study 2002/0812EU.dta")
se02raw<-read_dta("C:/Users/fh/Dropbox/Data/SND 0812 Swedish Election Study 2002/0812EV.dta")
str(se02raw)
str(se94raw)
str(se94raw)
str(se94raw)
str(se02raw)
1+1+5+2.5+1+2.5+1.5+2.5+1,5+1+5+5
1+1+5+2.5+1+2.5+1.5+2.5+1.5+1+5+5
1+1+5+2.5+1+2.5+1.5+2.5+1.5+1+5+5-1+9
install.packages("tufte")
load("https://github.com/antongrau/soc.elite/raw/master/data/den.rda")
load("C:/Users/fh/AppData/Local/Temp/den.rda")
View(den)
load("C:/Users/fh/AppData/Local/Temp/pe13.rda")
View(pe13)
load("C:/Users/fh/AppData/Local/Temp/directors08.rda")
View(directors08)
View(den)
require(dplyr)
require(magrittr)
?runif
n<-250
simdat<-data.frame(disttometro=runif(n,0,300))
View(simdat)
simdat<-data.frame(disttometro=runif(n,0,300),metrocomp=0)
View(simdat)
n<-250
simdat<-data.frame(disttometro=runif(n,0,300),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,1500,metrocomp))
View(simdat)
n<-250
simdat<-data.frame(disttometro=runif(n,0,300),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,1500,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,1000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,500,metrocomp))
View(simdat)
### define variables
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,1500,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,1000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,500,metrocomp))
View(simdat)
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,4000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,3000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,1000,metrocomp))
View(simdat)
?rnorm
### define variables
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,4000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,3000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,1000,metrocomp)) %>%
mutate(ownincome=rnorm(n,20000,5000))
View(simdat)
### define variables
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,4000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,3000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,1000,metrocomp)) %>%
mutate(ownincome=rnorm(n,20000,5000)) %>%
mutate(incomeboost=100*(metrocomp/ownincome))
View(simdat)
View(simdat)
hist(simdat$incomeboost)
### define variables
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,4000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,3000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,1000,metrocomp)) %>%
mutate(ownincome=rnorm(n,20000,5000)) %>%
mutate(incomeboost=100*(metrocomp/ownincome),
noise=60-disttometro*.3)
View(simdat)
### define variables
n<-250
simdat<-data.frame(disttometro=runif(n,0,350),metrocomp=0) %>%
mutate(metrocomp=ifelse(disttometro <= 50,4000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 100 & disttometro > 50,3000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 150 & disttometro > 100,2000,metrocomp)) %>%
mutate(metrocomp=ifelse(disttometro <= 200 & disttometro > 150,1000,metrocomp)) %>%
mutate(ownincome=rnorm(n,20000,5000)) %>%
mutate(incomeboost=100*(metrocomp/ownincome),
noise=ifelse(disttometro <= 120,60-disttometro*.2,0))
View(simdat)
require(lubridate)
require(dplyr)
require(magrittr)
require(ggplot2)
require(reshape2)
require(stargazer)
require(readr)
require(tidyr)
require(broom)
require(lme4)
require(arm)
#win
#setwd("C:/Users/fh/Documents/GitHub/parlbias/data")
#mac
setwd("~/GitHub/parlbias/data")
ftall<-readRDS("ftall.rds")
#remove very short and very long speeches
ft<-subset(ftall,secs<150 & secs>10 & year(starttime)>2000)
ft<-arrange(ft,starttime)
# #check sample of data
# sample_n(ft,30)
# ggplot(subset(ft,chair==0),aes(x=secs)) + geom_density()
# ggplot(ft,aes(x=timeofday,y=secs)) + geom_point() + facet_grid(debate~.)
### REGRESSION MODELS
#define basic models
m1<-lm(m1f<-as.formula(secs~copartisan),data=ft)
m2<-lm(m2f<-as.formula(secs~copartisan+timeofday),data=ft)
m3<-lm(m3f<-as.formula(secs~copartisan+timeofday+female+debatetype),data=ft)
m4<-lm(m4f<-as.formula(secs~copartisan+timeofday+female+debatetype+factor(coarseparty)),data=ft)
m5<-lm(m5f<-as.formula(secs~copartisan+timeofday+female+debatetype+factor(coarseparty)+factor(chairparty)),data=ft)
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("factor","debate"),omit.stat=c("f","ser"))
stargazer(m1,m2,m3,m4,m5,type="text",omit=c("debate"),omit.stat=c("f","ser"))
summary(mx<-lm(secs~copartisan+timeofday+female+factor(coarseparty)+factor(chairparty)+debate,data=ft))
summary(lm(m5f,data=ft))
summary(lm(m5f,data=sample_frac(ft,.5,replace=F)))
summary(lm(m5f,data=subset(ft,timeofday>11)))
# identify followups
ft$followup<-0
for (i in 5:nrow(ft)){
if (ft$chair[i]==0 & ft$fullname[i]==ft$fullname[i-2] & !(ft$fullname[i]==ft$fullname[i-4])){
ft$followup[i]<-1
}
}
table(ft$followup)
ggplot(subset(ft,copartisan<2),aes(x=secs)) +
geom_density() +
facet_grid(copartisan~followup) +
theme_bw()
summary(lm(m5f,data=subset(ft,followup==0)))
#conclusion: data is robust to the exclusion of followups, but they do not (solely) explain the bimodal distribution
#collect effect estimates in data frame
effectests<-data.frame(est=rep(NA,10),se=rep(NA,10),method=c(rep("OLS",5),rep("Logit",5)),model=rep(1:5,2))
effectests[1,1:2]<-tidy(m1)[2,2:3]
effectests[2,1:2]<-tidy(m2)[2,2:3]
effectests[3,1:2]<-tidy(m3)[2,2:3]
effectests[4,1:2]<-tidy(m4)[2,2:3]
effectests[5,1:2]<-tidy(m5)[2,2:3]
#what is the effect size in standardized terms? get cohen's d
cohensd <- effectests$est / sd(ft$secs)
barplot(cohensd)
#get average number of speeches
lengths<-ft %>%
group_by(debate,chairname) %>%
summarise(speeches=sum(chair)) %>%
filter(speeches>0)
meanspeechesperchair<-mean(lengths$speeches)
maxspeechesperchair<-max(lengths$speeches)
#how many seconds does 2.8 seconds add up to over the average debate per chair?
effectests$est[4]*maxspeechesperchair
summary(m1.logit<-glm(secsgt60~copartisan,data=ft,family=binomial()))
summary(m2.logit<-glm(secsgt60~copartisan+timeofday,data=ft,family=binomial()))
summary(m3.logit<-glm(secsgt60~copartisan+timeofday+female+debatetype,data=ft,family=binomial()))
summary(m4.logit<-glm(secsgt60~copartisan+timeofday+female+debatetype+factor(coarseparty),data=ft,family=binomial()))
summary(m5.logit<-glm(secsgt60~copartisan+timeofday+female+debatetype+factor(coarseparty)+factor(chairparty),data=ft,family=binomial()))
require(mfx)
effectests[6,1:2]<-logitmfx(m1.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[7,1:2]<-logitmfx(m2.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[8,1:2]<-logitmfx(m3.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[9,1:2]<-logitmfx(m4.logit$formula,data=ft)$mfxest[1,1:2]*100
effectests[10,1:2]<-logitmfx(m5.logit$formula,data=ft)$mfxest[1,1:2]*100
#for the main models, cluster observations by presiding chair
require(rms)
m1rob<-robcov(ols(m1f,data=ft,x=T,y=T),cluster=ft$chairname)
m2rob<-robcov(ols(m2f,data=ft,x=T,y=T),cluster=ft$chairname)
m3rob<-robcov(ols(m3f,data=ft,x=T,y=T),cluster=ft$chairname)
m4rob<-robcov(ols(m4f,data=ft,x=T,y=T),cluster=ft$chairname)
m5rob<-robcov(ols(m5f,data=ft,x=T,y=T),cluster=ft$chairname)
m5intposdifltmedian<-robcov(ols(m5f,data=subset(ft,intposdif<=2.34),x=T,y=T),cluster=subset(ft,intposdif<=2.34)$chairname)
m5ordposdifltmedian<-robcov(ols(m5f,data=subset(ft,ordposdif<=2),x=T,y=T),cluster=subset(ft,ordposdif<=2)$chairname)
m5cobloc<-robcov(ols(m5f,data=subset(ft,cobloc==1),x=T,y=T),cluster=subset(ft,cobloc==1)$chairname)
#setup up varying slopes model to test how the bias varies by
mlm3<-lmer(secs~copartisan+timeofday+female+(1|coarseparty)+(1+copartisan|chairparty),data=ft)
ranef(mlm3)
fixef(mlm3)
partyranefs<-data.frame(party=rownames(ranef(mlm3)$chairparty),coef=fixef(mlm3)[2]+ranef(mlm3)$chairparty[,2],se=se.ranef(mlm3)$chairparty[,2])
partyranefs
partyranefs<-ft %>%
group_by(coarseparty) %>%
summarise(ordpos=mean(chairordpos)) %>%
rename(party=coarseparty) %>%
left_join(partyranefs,.,by="party")
#varying slopes by chairman name
mlm3_chairs<-lmer(secs~copartisan+timeofday+female+(1|coarseparty)+(1+copartisan|chairname),data=ft)
ranef(mlm3_chairs)
fixef(mlm3_chairs)
chairranefs<-data.frame(chair=rownames(ranef(mlm3_chairs)$chairname),coef=fixef(mlm3)[2]+ranef(mlm3_chairs)$chairname[,2],se=se.ranef(mlm3_chairs)$chairname[,2])
chairranefs<-ft %>%
group_by(chairname,chairparty) %>%
summarise(ordpos=mean(chairordpos)) %>%
rename(party=chairparty,chair=chairname) %>%
left_join(chairranefs,.,by="chair") %>%
arrange(.,ordpos,-coef) %>%
mutate(chairorder=1:20,chairparty=paste(chair," ","(",party,")",sep=""))
#robustness check 1
require(rms)
m1robrs<-robcov(ols(m1f,data=subset(ft,leadshipparty==1),x=T,y=T),cluster=subset(ft,leadshipparty==1)$chairname)
m2robrs<-robcov(ols(m2f,data=subset(ft,leadshipparty==1),x=T,y=T),cluster=subset(ft,leadshipparty==1)$chairname)
m3robrs<-robcov(ols(m3f,data=subset(ft,leadshipparty==1),x=T,y=T),cluster=subset(ft,leadshipparty==1)$chairname)
m4robrs<-robcov(ols(m4f,data=subset(ft,leadshipparty==1),x=T,y=T),cluster=subset(ft,leadshipparty==1)$chairname)
m5robrs<-robcov(ols(m5f,data=subset(ft,leadshipparty==1),x=T,y=T),cluster=subset(ft,leadshipparty==1)$chairname)
#robustness check 2
m1fdfe<-as.formula(secs~copartisan+debate)
m2fdfe<-as.formula(secs~copartisan+timeofday+debate)
m3fdfe<-as.formula(secs~copartisan+timeofday+female+debate)
m4fdfe<-as.formula(secs~copartisan+timeofday+female+factor(coarseparty)+debate)
m5fdfe<-as.formula(secs~copartisan+timeofday+female+factor(coarseparty)+factor(chairparty)+debate)
m1robdfe<-robcov(ols(m1fdfe,data=ft,x=T,y=T),cluster=ft$chairname)
m2robdfe<-robcov(ols(m2fdfe,data=ft,x=T,y=T),cluster=ft$chairname)
m3robdfe<-robcov(ols(m3fdfe,data=ft,x=T,y=T),cluster=ft$chairname)
m4robdfe<-robcov(ols(m4fdfe,data=ft,x=T,y=T),cluster=ft$chairname)
m5robdfe<-robcov(ols(m5fdfe,data=ft,x=T,y=T),cluster=ft$chairname)
#get list of chairmen by debate
allchairmen<-ftall %>%
filter(chair==1) %>%
group_by(chairname,debate) %>%
summarise(remarks=length(chairname))
seatvec<-c(16,rep(22,2),rep(47,7),rep(8,3),rep(18,2),47,23,16,23,16,9,47,44,34,17,17,13,45,rep(47,3),45,rep(47,4),rep(22,4),37,25,22,25,22,16,14,rep(46,2)) #careful! here I manually type in the seats for each chairman's party by debate
allchairmen$seats<-seatvec
allchairmen<-allchairmen %>%
group_by(chairname) %>%
summarise(remarks=sum(remarks),debates=length(debate),avgseats=mean(seats)) %>%
mutate(president=ifelse(chairname %in% c("Thor Pedersen","Mogens Lykketoft","Pia Kjaersgaard"),1,0))
#can we predict chairman activity?
summary(remarksm1<-lm(remarks~president+debates,data=allchairmen))
summary(remarksm2<-lm(remarks~president+debates+avgseats,data=allchairmen))
summary(remarksm3<-lm(remarks~president+avgseats,data=allchairmen))
### TABLES
checkmarks<-c("Speaker party FE & & & & $\\checkmark$ & $\\checkmark$ \\\\", "Chair party FE & & & & & $\\checkmark$ \\\\")
#, "Debate FE & & & & $\\checkmark$ & $\\checkmark$ \\\\")
covarlabs<-c("Copartisan","Time of day","Gender (female)","Debate type (Opening)","Intercept")
regtab1<-stargazer(m1rob,m2rob,m3rob,m4rob,m5rob,style="apsr",omit=c("coarse","chair"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1",column.sep.width="-5pt",star.cutoffs=c(.1,.05,.01),align=T,title="OLS models of speaking time",digits=2,
covariate.labels=covarlabs)
regtab1<-c(regtab1[1:24],checkmarks,regtab1[25:length(regtab1)])
regtab1
writeLines(regtab1,con="../tables/parlbias_regtab1.txt")
regtab1logit<-stargazer(m1.logit,m2.logit,m3.logit,m4.logit,m5.logit,style="apsr",omit=c("coarse","chair","debate"),
dep.var.labels="Dummy: speaking time exceeds 60 seconds",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtab1logit",column.sep.width="-5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Logit models of exceeding standard speaking time",digits=2)
regtab1logit
regtab1logit<-c(regtab1logit[1:22],checkmarks,regtab1logit[23:length(regtab1logit)])
writeLines(regtab1logit,con="../tables/parlbias_regtab1logit.txt")
modscolumnlabels<-c("Full","Distance$\\leq$median (int.)","Distance$\\leq$median (ord.)","Same bloc")
modscheckmarks<-c("Speaker party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\", "Chair party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
#, "Debate FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
regtabmods<-stargazer(m5rob,m5intposdifltmedian,m5ordposdifltmedian,m5cobloc,style="apsr",omit=c("coarse","chair","debate"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="-5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods
regtabmods<-c(regtabmods[1:23],modscheckmarks,regtabmods[24:length(regtabmods)])
regtabmods
m5cobloc<-robcov(ols(m5f,data=subset(ft,cobloc==1),x=T,y=T))
print(m5cobloc)
str(m5cobloc)
m5cobloc<-ols(m5f,data=subset(ft,cobloc==1),x=T,y=T)
print(m5cobloc)
stargazer(m5cobloc)
?ols
print(ols(m5f,data=subset(ft,cobloc==1)))
print(ols(m5f,data=ft))
print(ols(m5f,data=subset(ft,cobloc==1)))
print(ols(m5f,data=subset(ft,cobloc==1),se.fit=T))
print(ols(m5f,data=subset(ft,cobloc==1),se.fit=T,tol=1000))
print(ols(m5f,data=subset(ft,cobloc==1),se.fit=T,tol=2))
stargazer(ols(m5f,data=subset(ft,cobloc==1)))
stargazer(ols(m5f,data=subset(ft,cobloc==1)),omit=c("chair","coarse"))
m5cobloc<-ols(m5f,data=subset(ft,cobloc==1),x=T,y=T)
modscolumnlabels<-c("Full","Distance$\\leq$median (int.)","Distance$\\leq$median (ord.)","Same bloc")
modscheckmarks<-c("Speaker party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\", "Chair party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
#, "Debate FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
regtabmods<-stargazer(m5rob,m5intposdifltmedian,m5ordposdifltmedian,m5cobloc,style="apsr",omit=c("coarse","chair","debate"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="-5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods
regtabmods<-c(regtabmods[1:23],modscheckmarks,regtabmods[24:length(regtabmods)])
regtabmods
modscolumnlabels<-c("Full","Distance$\\leq$median (int.)","Distance$\\leq$median (ord.)","Same bloc")
modscheckmarks<-c("Speaker party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\", "Chair party FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
#, "Debate FE & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ & $\\checkmark$ \\\\")
regtabmods<-stargazer(m5rob,m5intposdifltmedian,m5ordposdifltmedian,m5cobloc,style="apsr",omit=c("coarse","chair","debate"),
dep.var.labels="Speaking time (seconds)",dep.var.labels.include=T,font.size="footnotesize",
label="parlbias_regtabmods",column.sep.width="-5pt",covariate.labels=covarlabs,star.cutoffs=c(.1,.05,.01),
align=T,title="Tests of political moderators",digits=2,column.labels=modscolumnlabels)
regtabmods
regtabmods<-c(regtabmods[1:23],modscheckmarks,regtabmods[24:length(regtabmods)])
regtabmods
writeLines(regtabmods,con="../tables/parlbias_regtabmods.txt")
